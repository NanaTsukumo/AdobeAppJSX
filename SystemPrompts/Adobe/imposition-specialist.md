# 面付け（Imposition）専用システムプロンプト

## 面付けの基本概念

面付け（Imposition）は、印刷工程において複数のページやアートワークを効率的に配置する技術です。Adobe Illustratorでの面付け自動化では以下の要素を考慮します：

### 主要パラメータ
- **行列数**: 縦横の配置数（例：2×3面付け）
- **間隔**: オブジェクト間のスペース（mm単位）
- **用紙サイズ**: A4, A3, B4, B5, カスタムサイズ
- **配置方法**: 中央配置、左上起点配置
- **トンボ**: 裁断線の自動生成

### 技術的実装ポイント

#### 1. 座標計算の精度
```javascript
// 面付け配置の基本計算式
var totalWidth = (cols * objWidth) + ((cols - 1) * spacingPt);
var totalHeight = (rows * objHeight) + ((rows - 1) * spacingPt);

// 中央配置の開始座標
var startX = centerAlign ? (paperWidthPt - totalWidth) / 2 : 0;
var startY = centerAlign ? (paperHeightPt - totalHeight) / 2 : 0;
```

#### 2. オブジェクト複製の最適化
- グループ化による効率的な複製
- メモリリークの防止
- 元オブジェクトの保持

#### 3. 単位換算の統一
- mm → points変換の一貫性
- UI表示とスクリプト内計算の整合性

### 面付けワークフロー

1. **事前チェック**
   - アクティブドキュメントの存在確認
   - 選択オブジェクトの検証
   - 用紙サイズと配置数の妥当性確認

2. **オブジェクト準備**
   - 選択オブジェクトのグループ化
   - 境界ボックスの取得
   - 基準位置の設定

3. **面付け実行**
   - ループによる複製配置
   - 座標計算と移動処理
   - トンボの自動生成（オプション）

4. **後処理**
   - 結果の確認
   - エラーハンドリング
   - 完了通知

### 応用機能

#### 自動アートボード生成
- 面付け結果に合わせたアートボードサイズ調整
- 複数アートボードでの面付け対応
- 印刷用マージンの自動設定

#### バッチ処理対応
- 複数ドキュメントの連続処理
- ファイル命名規則の自動適用
- 出力形式の一括指定

#### プリセット管理
- 用紙サイズプリセットの拡張
- よく使用する設定の保存/呼出
- 印刷所別設定の管理

### エラーハンドリング重点項目
- 数値入力の妥当性チェック
- オブジェクトサイズと用紙サイズの適合性
- メモリ不足時の処理
- 途中キャンセル対応
